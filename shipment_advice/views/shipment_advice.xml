<?xml version="1.0" encoding="utf-8" ?>
<!-- Copyright 2021 Camptocamp SA
     License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl). -->
<odoo>
    <record id="shipment_advice_view_form" model="ir.ui.view">
        <field name="name">shipment.advice.form</field>
        <field name="model">shipment.advice</field>
        <field name="arch" type="xml">
            <form string="Shipment Advice">
                <header>
                    <button
                        name="action_confirm"
                        type="object"
                        string="Confirm"
                        class="oe_highlight"
                        states="draft"
                    />
                    <button
                        name="action_in_progress"
                        type="object"
                        string="Start"
                        class="oe_highlight"
                        states="confirmed"
                    />
                    <button
                        name="action_done"
                        type="object"
                        string="Mark as done"
                        class="oe_highlight"
                        states="in_progress"
                    />
                    <button
                        name="action_cancel"
                        type="object"
                        string="Cancel"
                        class="oe_highlight"
                        states="confirmed,in_progress"
                    />
                    <button
                        name="action_draft"
                        type="object"
                        string="Back to draft"
                        class="oe_highlight"
                        states="cancel"
                    />
                    <field
                        name="state"
                        widget="statusbar"
                        statusbar_visible="draft,confirmed,in_progress,done"
                    />
                </header>
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button
                            name="button_open_planned_pickings"
                            type="object"
                            string="Planned Transfers"
                            class="oe_stat_button"
                            icon="fa-arrows-v"
                            attrs="{'invisible': [('planned_picking_ids', '=', [])]}"
                        />
                        <button
                            name="button_open_planned_moves"
                            type="object"
                            class="oe_stat_button"
                            icon="fa-arrows-v"
                            attrs="{'invisible': [('planned_move_ids', '=', [])]}"
                        >
                            <div class="o_form_field o_stat_info">
                                <span class="o_stat_text">Planned Content List</span>
                            </div>
                        </button>
                        <button
                            name="button_open_loaded_pickings"
                            type="object"
                            string="Transfers"
                            class="oe_stat_button"
                            icon="fa-arrows-v"
                            attrs="{'invisible': ['|', ('shipment_type', '!=', 'outgoing'), ('loaded_picking_ids', '=', [])]}"
                        />
                        <button
                            name="button_open_loaded_move_lines"
                            type="object"
                            string="Content List"
                            class="oe_stat_button"
                            icon="fa-arrows-v"
                            attrs="{'invisible': ['|', ('shipment_type', '!=', 'outgoing'), ('loaded_move_line_ids', '=', [])]}"
                        />
                        <button
                            name="button_open_loaded_packages"
                            type="object"
                            string="Packages"
                            class="oe_stat_button"
                            icon="fa-arrows-v"
                            attrs="{'invisible': ['|', ('shipment_type', '!=', 'outgoing'), ('loaded_package_ids', '=', [])]}"
                        />
                        <button
                            name="button_open_deliveries_in_progress"
                            type="object"
                            string="Loading Progress"
                            class="oe_stat_button"
                            icon="fa-arrows-v"
                            attrs="{'invisible': ['|', ('shipment_type', '!=', 'outgoing'), ('state', '!=', 'in_progress'), ('loaded_picking_ids', '=', [])]}"
                        />
                    </div>
                    <h1>
                        <field name="name" attrs="{'invisible': [('name','=','/')]}" />
                    </h1>
                    <group>
                        <group name="info1">
                            <field
                                name="warehouse_id"
                                groups="stock.group_stock_multi_warehouses"
                            />
                            <field
                                name="company_id"
                                groups="base.group_multi_company"
                            />
                            <field name="shipment_type" />
                        </group>
                        <group name="info2">
                            <field name="dock_id" />
                            <field name="arrival_date" />
                            <field name="departure_date" />
                            <field name="ref" />
                        </group>
                    </group>
                    <notebook>
                        <page string="Planned content list">
                            <group name="planned_moves" string="Planned moves">
                                <field
                                    name="planned_move_ids"
                                    nolabel="1"
                                    domain="[('picking_type_id.code', '=', shipment_type)]"
                                />
                            </group>
                            <group name="planned_pickings" string="Planned transfers">
                                <field name="planned_picking_ids" nolabel="1" />
                            </group>
                        </page>
                        <page string="Loaded content list">
                            <group name="loaded_move_lines" string="Loaded move lines">
                                <field
                                    name="loaded_move_line_ids"
                                    nolabel="1"
                                    domain="[('picking_id.picking_type_id.code', '=', shipment_type)]"
                                />
                            </group>
                            <group name="loaded_pickings" string="Loaded transfers">
                                <field name="loaded_picking_ids" nolabel="1" />
                            </group>
                            <group name="loaded_packages" string="Loaded packages">
                                <field name="loaded_package_ids" nolabel="1" />
                            </group>
                        </page>
                    </notebook>
                    <group class="oe_right" name="total_load">
                        <div class="oe_subtotal_footer_separator oe_inline o_td_label">
                            <label for="total_load" />
                        </div>
                        <strong>
                            <field
                                name="total_load"
                                nolabel="1"
                                class="oe_subtotal_footer_separator"
                            />
                        </strong>
                    </group>
                </sheet>
            </form>
        </field>
    </record>
    <record id="shipment_advice_view_tree" model="ir.ui.view">
        <field name="name">shipment.advice.tree</field>
        <field name="model">shipment.advice</field>
        <field name="arch" type="xml">
            <tree
                string="Shipment Advices"
                decoration-info="state == 'draft'"
                decoration-muted="state == 'cancel'"
                decoration-danger="state not in ('draft', 'cancel', 'done') and arrival_date &lt; current_date"
            >
                <field name="name" />
                <field name="shipment_type" />
                <field name="dock_id" />
                <field name="arrival_date" />
                <field name="departure_date" />
                <field name="ref" />
                <field name="total_load" />
                <field
                    name="warehouse_id"
                    groups="stock.group_stock_multi_warehouses"
                />
                <field name="company_id" groups="base.group_multi_company" />
                <field name="state" />
            </tree>
        </field>
    </record>
    <record id="shipment_advice_action" model="ir.actions.act_window">
        <field name="name">Shipment Advices</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">shipment.advice</field>
        <field name="view_id" ref="shipment_advice_view_tree" />
    </record>
    <menuitem
        id="shipment_advice_menu"
        parent="stock.menu_stock_warehouse_mgmt"
        action="shipment_advice_action"
    />
</odoo>
